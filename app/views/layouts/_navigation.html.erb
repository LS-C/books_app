
<div id="vertical-menubar" class="ui left fixed vertical menu">
  <% if !signed_in? %>
  <div class="header item">
    <a href="/publishing_companies/sign_in" class="item">Clients Sign-in</a>
    <a href="/authors/sign_in" class="item">Members Sign-in</a>
  </div>
  <a class="item">
    About Us
  </a>
  <a class="item">
    Jobs
  </a>
  <%else%>
  <div class="header item">
    Products
  </div>

  <div class="item">
    Library
    <div class="menu">
      <% if current_author %>
        <%= link_to current_author do %>
          <p id="authors-profile-pg" class="item">Account</p>
        <%end%>
        <a id="authors-books-pg" class="item">Books</a>
        <a class="item">Member Companies</a>
        <a class="item">Messages</a>

      <% else  %>
        <%= link_to current_publishing_company do %>
          <p class="item">Account</p>
        <%end%>
        <a class="item">Authors</a>
        <a class="item">Books</a>
      <% end %>
    </div>
  </div>
  <a href="/" class="item">
    About Us
  </a>
  <a class="item">
    Jobs
  </a>
  <%= link_to(destroy_author_session_path, :method=>'delete') do %>
  <p class="item">Logout</p>
  <% end %>

  <%end%>
</div>



<script type="text/javascript">

$(function() {

  $("#authors-books-pg").click(function() {
    $('html,body').animate({
      scrollTop: $(".second").offset().top},
      'slow');
      $('.sort-book-options').show()
      getCurrentBooks()
    });

})


function getCurrentBooks() {
    const id = $('#authors-books').attr('data-id')
    let title;
    posting = $.getJSON('/authors/'+id+'/book_data', function(data) {
        const books = data["books"]
        const authorBooks = books.map(book => {
            title = book.title === "" ? '<em>untitled</em>' : titleCase(book.title)
            // return `<div class="four wide column"><a href="/authors/${id}/books/${book.id}" class="book-link" >`+title+'</a></div><br/>'
            return displayCard(book)
        })
        authorBooks.forEach( book => {
            $("#authors-books").append(book)
        })
      })
}


function displayCard(data) {
  const book = data
  const title = book.title === "" ? '<em>untitled</em>' : titleCase(book.title)
  return `<div class="card">
    <div class="content">
      <div class="book_cards">
          <a href="/books/${book.id}" class="book-link" onclick="log(${book.id}); return false;" >${title}</a>
      </div>
    </div>
  </div>`
}

function titleCase(title) {
  if (title.indexOf(' ') === -1) {
    return title.charAt(0).toUpperCase()+title.slice(1)
  } else{
    return title.split(" ").map( word => { return word.charAt(0).toUpperCase()+word.slice(1) }).join(" ")
  }
}


</script>
