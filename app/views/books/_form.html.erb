<%= form_for @book do |f| %>
    <%= f.label :title %>
    <%= f.text_field :title %>
    <%= f.label :category %>
    <%= f.text_field :category %>
    <%= f.label :description %>
    <%= f.text_field :description %>
    <%= f.hidden_field :author_id, value: @author.id %>

    <%= f.submit %>
<%end%>
<p id="author-id" data-id=<%=@author.id%>></div>

<script type="text/javascript">
    $('form').submit(function(e) {
        e.preventDefault()
        const id = $('#author-id').attr('data-id')
        console.log(id)
        const values = $(this).serialize()
        posting = $.post('/books', values)
        posting.done(function(values) {
            getCurrentBooks()
        })
    })


function getCurrentBooks() {
    const id = $('#author-id').attr('data-id')
    console.log(id)
    posting = $.getJSON('/authors/'+id+'author_books', function(data) {
        console.log(data)
        console.log('get current book function is running')
    })
}

</script>
